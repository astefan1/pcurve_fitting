<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Felix Schönbrodt &amp; Angelika Stefan">
<meta name="dcterms.date" content="2025-09-23">

<title>Evaluation of p-curve simulation results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="eval_simResults_files/libs/clipboard/clipboard.min.js"></script>
<script src="eval_simResults_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="eval_simResults_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="eval_simResults_files/libs/quarto-html/popper.min.js"></script>
<script src="eval_simResults_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="eval_simResults_files/libs/quarto-html/anchor.min.js"></script>
<link href="eval_simResults_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="eval_simResults_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="eval_simResults_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="eval_simResults_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="eval_simResults_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Evaluation of p-curve simulation results</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Felix Schönbrodt &amp; Angelika Stefan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 23, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==============================================================================</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Eval scenarios</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==============================================================================</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fitPCurve)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The working directory should be the project root</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">".."</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># reference p-curves</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>pcurves <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"simulations/reference-pcurves.csv"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># load the multiple DV simulation results:</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>simres_realistic <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"simulations/sim-results/sim_realistic.csv"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>simres_worst <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"simulations/sim-results/sim_worst.csv"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>simres_perfect <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"simulations/sim-results/sim_perfect.csv"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>simres_H0 <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"simulations/sim-results/sim_H0.csv"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># load the optional stopping simulation results:</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>simres_optStop_worst <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"simulations/sim-results/sim_optStop_worst.csv"</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>simres_optStop_realistic <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"simulations/sim-results/sim_optStop_realistic.csv"</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>simres_multDV <span class="ot">&lt;-</span> <span class="fu">rbind</span>(simres_realistic, simres_worst, simres_perfect, simres_H0)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>simres_multDV<span class="sc">$</span>binsum <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(simres_multDV[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)])</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all</span>(simres_multDV<span class="sc">$</span>binsum <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">6</span>) <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>simres_multDV<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"multDV"</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>simres_optStop <span class="ot">&lt;-</span> <span class="fu">rbind</span>(simres_optStop_realistic, simres_optStop_worst)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>simres_optStop<span class="sc">$</span>binsum <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(simres_optStop[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)])</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all</span>(simres_optStop<span class="sc">$</span>binsum <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">6</span>) <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>simres_optStop<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"optStop"</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co"># combine simulations from both p-hacking strategies (they have different parameter columns)</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>simres <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(simres_multDV, simres_optStop)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>simres_multDV<span class="sc">$</span>rmseSotola    <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_multDV[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">rmse</span>(x, <span class="fu">simplify2array</span>(pcurves[<span class="dv">1</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)])))</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>simres_multDV<span class="sc">$</span>rmseWetzels   <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_multDV[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">rmse</span>(x, <span class="fu">simplify2array</span>(pcurves[<span class="dv">2</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)])))</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>simres_multDV<span class="sc">$</span>rmseSimonsohn <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_multDV[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">rmse</span>(x, <span class="fu">simplify2array</span>(pcurves[<span class="dv">3</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)])))</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>simres_optStop<span class="sc">$</span>rmseSotola    <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_optStop[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">rmse</span>(x, <span class="fu">simplify2array</span>(pcurves[<span class="dv">1</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)])))</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>simres_optStop<span class="sc">$</span>rmseWetzels   <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_optStop[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">rmse</span>(x, <span class="fu">simplify2array</span>(pcurves[<span class="dv">2</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)])))</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>simres_optStop<span class="sc">$</span>rmseSimonsohn <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_optStop[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">rmse</span>(x, <span class="fu">simplify2array</span>(pcurves[<span class="dv">3</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)])))</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>simres_multDV<span class="sc">$</span>chi2Sotola    <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_multDV[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">chi2</span>(x, <span class="fu">simplify2array</span>(pcurves[<span class="dv">1</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)]), <span class="at">n =</span> pcurves<span class="sc">$</span>nsig[<span class="dv">1</span>])</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>simres_multDV<span class="sc">$</span>chi2Wetzels   <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_multDV[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">chi2</span>(x, <span class="fu">simplify2array</span>(pcurves[<span class="dv">2</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)]), <span class="at">n =</span> pcurves<span class="sc">$</span>nsig[<span class="dv">2</span>])</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>simres_multDV<span class="sc">$</span>chi2Simonsohn <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_multDV[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">chi2</span>(x, <span class="fu">simplify2array</span>(pcurves[<span class="dv">3</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)]), <span class="at">n =</span> pcurves<span class="sc">$</span>nsig[<span class="dv">3</span>])</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>simres_optStop<span class="sc">$</span>chi2Sotola    <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_optStop[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">chi2</span>(x, <span class="fu">simplify2array</span>(pcurves[<span class="dv">1</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)]), <span class="at">n =</span> pcurves<span class="sc">$</span>nsig[<span class="dv">1</span>])</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>simres_optStop<span class="sc">$</span>chi2Wetzels   <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_optStop[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x)</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">chi2</span>(x, <span class="fu">simplify2array</span>(pcurves[<span class="dv">2</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)]), <span class="at">n =</span> pcurves<span class="sc">$</span>nsig[<span class="dv">2</span>])</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>simres_optStop<span class="sc">$</span>chi2Simonsohn <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_optStop[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x)</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">chi2</span>(x, <span class="fu">simplify2array</span>(pcurves[<span class="dv">3</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)]), <span class="at">n =</span> pcurves<span class="sc">$</span>nsig[<span class="dv">3</span>])</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="co"># # A heatmap with all conditions (no averaging; each condition is one tile)</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(simres, aes(x = d, y = prop_H1, fill = rmseSimonsohn)) +</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_tile() +</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a><span class="co">#     rows = vars(het, nvar, strategy),      # two stacked facet rows</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a><span class="co">#     cols = vars(r, prop_Hacker)  # two stacked facet columns</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_viridis_c(</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a><span class="co">#     option = "inferno",</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a><span class="co">#     direction = -1,</span></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a><span class="co">#     values = c(0, 0.1, 1),</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a><span class="co">#     limits=c(</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a><span class="co">#       min(simres |&gt; select(contains("rmse"))),</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a><span class="co">#       max(simres |&gt; select(contains("rmse")))</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(breaks = sort(unique(simres$r))) +</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal(base_size = 9) +</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a><span class="co">#     panel.spacing.x = unit(0.01, "lines"),</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a><span class="co">#     panel.spacing.y = unit(0.01, "lines")</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------------------</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Some sanity checks</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation between our two GOF measures (rmse and chi2)</span></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(simres_multDV<span class="sc">$</span>rmseSotola, simres_multDV<span class="sc">$</span>chi2Sotola)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9600674</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(simres_multDV<span class="sc">$</span>rmseWetzels, simres_multDV<span class="sc">$</span>chi2Wetzels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9211928</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(simres_multDV<span class="sc">$</span>rmseSimonsohn, simres_multDV<span class="sc">$</span>chi2Simonsohn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7072613</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(simres_optStop<span class="sc">$</span>rmseSotola, simres_optStop<span class="sc">$</span>chi2Sotola)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9443455</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(simres_optStop<span class="sc">$</span>rmseWetzels, simres_optStop<span class="sc">$</span>chi2Wetzels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8512569</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(simres_optStop<span class="sc">$</span>rmseSimonsohn, simres_optStop<span class="sc">$</span>chi2Simonsohn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9168207</code></pre>
</div>
</div>
<section id="some-synthetic-p-curves-testing-specific-scenarios" class="level1">
<h1>Some synthetic p-curves: Testing specific scenarios</h1>
<section id="test-a-pure-bump" class="level2">
<h2 class="anchored" data-anchor-id="test-a-pure-bump">Test a pure bump</h2>
<section id="multiple-dvs" class="level3">
<h3 class="anchored" data-anchor-id="multiple-dvs">Multiple DVs</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="eval_simResults_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The best fitting scenarios from the “multiple DVs” simulations are:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>simres_multDV <span class="sc">|&gt;</span> <span class="fu">arrange</span>(rmseBump) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  nvar   r   d prop_Hacker prop_H1 het  iter alpha strategy         p1
1  150 0.9 0.0        0.75     0.0 0.0 10000  0.05        3 0.05175781
2  150 0.9 0.1        1.00     0.1 0.0 10000  0.05        3 0.05680934
3  150 0.9 0.0        1.00     0.0 0.0 10000  0.05        3 0.05342303
4  150 0.9 0.1        0.50     0.1 0.0 10000  0.05        3 0.09027336
5  150 0.9 0.1        1.00     0.1 0.2 10000  0.05        3 0.07048124
          p2        p3        p4        p5 binsum   type rmseSotola rmseWetzels
1 0.09570312 0.1586914 0.2792969 0.4145508      1 multDV  0.3254085   0.3419727
2 0.09961089 0.1715953 0.2661479 0.4058366      1 multDV  0.3202030   0.3373624
3 0.09814009 0.1658093 0.2774040 0.4052236      1 multDV  0.3228399   0.3395019
4 0.11379530 0.1538462 0.2422123 0.3998729      1 multDV  0.3029560   0.3199586
5 0.10420614 0.1667298 0.2588102 0.3997726      1 multDV  0.3127665   0.3298375
  rmseSimonsohn chi2Sotola chi2Wetzels chi2Simonsohn rmseBump
1     0.2498469   536.7316    2295.764      48.55989 1.605294
2     0.2437433   499.2866    2193.129      44.72326 1.608925
3     0.2467905   522.3843    2218.770      47.24313 1.609405
4     0.2254008   436.5530    2013.302      37.65813 1.610858
5     0.2359990   473.7034    2098.273      41.98008 1.611346</code></pre>
</div>
</div>
</section>
<section id="optional-stopping" class="level3">
<h3 class="anchored" data-anchor-id="optional-stopping">Optional Stopping</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all optStop scenarios:</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>simres_optStop<span class="sc">$</span>rmseBump <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_optStop[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">rmse</span>(x, <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">15</span>, .<span class="dv">15</span>, .<span class="dv">15</span>, <span class="fl">4.0</span>)))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pcurves</span>(simres_optStop, <span class="at">poriginal =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">15</span>, .<span class="dv">15</span>, .<span class="dv">15</span>, .<span class="dv">40</span>), <span class="at">n_best =</span> <span class="dv">10</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Optional Stopping"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="eval_simResults_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The best fitting scenarios from the “optional stopping” simulations are:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>simres_optStop <span class="sc">|&gt;</span> <span class="fu">arrange</span>(rmseBump) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  prop_Hacker prop_H1 nmin nmax stepsize   d het         p1         p2
1        1.00     0.7   50 1063        1 0.1   0 0.02125788 0.02081806
2        1.00     0.5   50 1063        1 0.1   0 0.01904922 0.02090357
3        1.00     0.3   50 1063        1 0.1   0 0.02152252 0.02431248
4        1.00     0.0  177 1063        1 0.0   0 0.04191617 0.03255988
5        0.75     0.7   50 1063        1 0.1   0 0.03173113 0.02741269
          p3         p4        p5
1 0.02067146 0.09133558 0.8459170
2 0.02292650 0.09811194 0.8390088
3 0.02331606 0.10482264 0.8260263
4 0.04079341 0.06324850 0.8214820
5 0.02647390 0.09387908 0.8205032</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Test a "true signal + bump" pattern with a custom p-curve</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>reference <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">40</span>, .<span class="dv">20</span>, .<span class="dv">10</span>, .<span class="dv">05</span>, .<span class="dv">25</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>reference <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">45</span>, .<span class="dv">22</span>, .<span class="dv">14</span>, .<span class="dv">05</span>, .<span class="dv">14</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># all multDV scenarios:</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>simres_multDV<span class="sc">$</span>rmseBump2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_multDV[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">rmse</span>(x, reference))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pcurves</span>(simres_multDV, <span class="at">poriginal =</span> reference, <span class="at">n_best =</span> <span class="dv">10</span>, <span class="at">GOF=</span><span class="st">"rmse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="eval_simResults_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>simres_multDV <span class="sc">|&gt;</span> <span class="fu">arrange</span>(rmseBump2) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  nvar   r   d prop_Hacker prop_H1 het  iter alpha strategy        p1        p2
1   70 0.3 0.2        0.10     0.3 0.2 10000  0.05        1 0.4505194 0.2072171
2   70 0.3 0.2        0.10     0.3 0.2 10000  0.05        2 0.4505194 0.2072171
3    2 0.9 0.5        0.25     0.1 0.2 10000  0.05        1 0.4496047 0.1837945
4    2 0.9 0.5        0.25     0.1 0.2 10000  0.05        2 0.4496047 0.1837945
5  150 0.6 0.1        0.25     0.5 0.2 10000  0.05        1 0.4635548 0.1906643
         p3        p4        p5 binsum   type rmseSotola rmseWetzels
1 0.1361400 0.1027884 0.1033352      1 multDV  0.1110485   0.1196766
2 0.1361400 0.1027884 0.1033352      1 multDV  0.1110485   0.1196766
3 0.1363636 0.1037549 0.1264822      1 multDV  0.1077892   0.1194316
4 0.1363636 0.1037549 0.1264822      1 multDV  0.1077892   0.1194316
5 0.1432675 0.0983842 0.1041293      1 multDV  0.1023028   0.1128099
  rmseSimonsohn chi2Sotola chi2Wetzels chi2Simonsohn rmseBump  rmseBump2
1    0.03097270   58.03606    162.1446      1.806715 1.748142 0.02935813
2    0.03097270   58.03606    162.1446      1.806715 1.748142 0.02935813
3    0.03289787   50.83429    178.5088      1.845006 1.737663 0.02965314
4    0.03289787   50.83429    178.5088      1.845006 1.737663 0.02965314
5    0.03258715   47.38387    149.1472      1.664931 1.748170 0.03060305</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all optStop scenarios:</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>simres_optStop<span class="sc">$</span>rmseBump2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(simres_optStop[, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">rmse</span>(x, reference))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pcurves</span>(simres_optStop, <span class="at">poriginal =</span> reference, <span class="at">n_best =</span> <span class="dv">10</span>, <span class="at">GOF=</span><span class="st">"rmse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="eval_simResults_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>simres_optStop <span class="sc">|&gt;</span> <span class="fu">arrange</span>(rmseBump2) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  prop_Hacker prop_H1 nmin nmax stepsize   d het        p1        p2        p3
1        0.25     0.2    8  177      100 0.4 0.0 0.4613402 0.1836340 0.1327320
2        0.25     0.7   50  177      100 0.3 0.0 0.4371400 0.1928160 0.1494409
3        0.10     0.5    8  177       50 0.4 0.0 0.4735043 0.1880342 0.1346154
4        0.10     0.7   50  444      100 0.2 0.2 0.4736318 0.1796020 0.1402985
5        0.10     0.1   50  444      100 0.6 0.0 0.4668435 0.1847922 0.1388152
          p4        p5 binsum    type rmseSotola rmseWetzels rmseSimonsohn
1 0.10309278 0.1192010      1 optStop 0.10272854   0.1134456    0.03340783
2 0.10742121 0.1131820      1 optStop 0.11435450   0.1256108    0.03475195
3 0.09829060 0.1055556      1 optStop 0.09787341   0.1076412    0.03359447
4 0.09651741 0.1099502      1 optStop 0.09614492   0.1075657    0.03451769
5 0.10256410 0.1069850      1 optStop 0.10037557   0.1106853    0.03488969
  chi2Sotola chi2Wetzels chi2Simonsohn rmseBump  rmseBump2
1   48.36542    157.5670      1.844152 1.741331 0.03083942
2   57.04866    185.2232      2.102375 1.743184 0.03165401
3   45.21506    136.1953      1.671215 1.747896 0.03200519
4   41.48656    141.0959      1.614654 1.745913 0.03242656
5   47.15790    144.1320      1.900789 1.746971 0.03279534</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>simres_multDV[<span class="fu">order</span>(simres_multDV<span class="sc">$</span>chi2Sotola)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      nvar   r   d prop_Hacker prop_H1 het  iter alpha strategy        p1
20539    5 0.3 0.6        0.10     0.3 0.2 10000  0.05        1 0.6347359
20540    5 0.3 0.6        0.10     0.3 0.2 10000  0.05        2 0.6347359
18991    5 0.9 0.8        0.50     0.2 0.2 10000  0.05        1 0.6434741
18992    5 0.9 0.8        0.50     0.2 0.2 10000  0.05        2 0.6434741
43726    1 0.0 0.8        0.00     0.2 0.2 10000  0.05        1 0.6661220
43727    1 0.0 0.8        0.00     0.2 0.2 10000  0.05        2 0.6661220
43728    1 0.0 0.8        0.00     0.2 0.2 10000  0.05        3 0.6661220
23571   30 0.3 0.8        0.10     0.5 0.2 10000  0.05        3 0.6943221
38335    2 0.6 0.5        0.25     0.5 0.4 10000  0.05        1 0.6895119
38336    2 0.6 0.5        0.25     0.5 0.4 10000  0.05        2 0.6895119
              p2         p3         p4         p5 binsum   type rmseSotola
20539 0.11280215 0.10698299 0.06490600 0.08057296      1 multDV 0.02277475
20540 0.11280215 0.10698299 0.06490600 0.08057296      1 multDV 0.02277475
18991 0.10748560 0.09884837 0.06621881 0.08397313      1 multDV 0.02219649
18992 0.10748560 0.09884837 0.06621881 0.08397313      1 multDV 0.02219649
43726 0.10457516 0.09204793 0.06372549 0.07352941      1 multDV 0.02392749
43727 0.10457516 0.09204793 0.06372549 0.07352941      1 multDV 0.02392749
43728 0.10457516 0.09204793 0.06372549 0.07352941      1 multDV 0.02392749
23571 0.10150637 0.08644264 0.05585168 0.06187717      1 multDV 0.03081339
38335 0.09484251 0.08965040 0.06230530 0.06368986      1 multDV 0.02885152
38336 0.09484251 0.08965040 0.06230530 0.06368986      1 multDV 0.02885152
      rmseWetzels rmseSimonsohn chi2Sotola chi2Wetzels chi2Simonsohn rmseBump
20539  0.03074624    0.09992626   5.823492   22.136222      3.664458 1.766768
20540  0.03074624    0.09992626   5.823492   22.136222      3.664458 1.766768
18991  0.02711039    0.10452397   6.009164   20.282298      3.995131 1.765799
18992  0.02711039    0.10452397   6.009164   20.282298      3.995131 1.765799
43726  0.01711846    0.11494797   6.211888   10.471120      4.739281 1.771802
43727  0.01711846    0.11494797   6.211888   10.471120      4.739281 1.771802
43728  0.01711846    0.11494797   6.211888   10.471120      4.739281 1.771802
23571  0.01304563    0.12763892   6.308225    6.332935      5.663252 1.778783
38335  0.01382056    0.12688149   6.666692    7.091974      5.711342 1.777638
38336  0.01382056    0.12688149   6.666692    7.091974      5.711342 1.777638
      rmseBump2
20539 0.1004616
20540 0.1004616
18991 0.1050592
18992 0.1050592
43726 0.1157046
43727 0.1157046
43728 0.1157046
23571 0.1286389
38335 0.1277029
38336 0.1277029</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>simres_multDV[<span class="fu">order</span>(simres_multDV<span class="sc">$</span>chi2Wetzels)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      nvar   r   d prop_Hacker prop_H1 het  iter alpha strategy        p1
10224    2 0.0 0.7        0.50     0.5 0.0 10000  0.05        3 0.6895537
24028    2 0.9 0.6        0.25     0.5 0.2 10000  0.05        1 0.6835564
24029    2 0.9 0.6        0.25     0.5 0.2 10000  0.05        2 0.6835564
25132   10 0.0 0.6        0.75     0.5 0.2 10000  0.05        1 0.6883833
25133   10 0.0 0.6        0.75     0.5 0.2 10000  0.05        2 0.6883833
10747    5 0.3 0.6        0.75     0.5 0.0 10000  0.05        1 0.6781063
10748    5 0.3 0.6        0.75     0.5 0.0 10000  0.05        2 0.6781063
24642    2 0.3 0.7        0.50     0.5 0.2 10000  0.05        3 0.6907559
26260    2 0.9 0.5        0.10     0.7 0.2 10000  0.05        1 0.6776111
26261    2 0.9 0.5        0.10     0.7 0.2 10000  0.05        2 0.6776111
             p2         p3         p4         p5 binsum   type rmseSotola
10224 0.1123100 0.07381069 0.07184895 0.05247670      1 multDV 0.03902260
24028 0.1169535 0.07361377 0.07233907 0.05353728      1 multDV 0.03871197
24029 0.1169535 0.07361377 0.07233907 0.05353728      1 multDV 0.03871197
25132 0.1158221 0.07635298 0.07032058 0.04912099      1 multDV 0.03907481
25133 0.1158221 0.07635298 0.07032058 0.04912099      1 multDV 0.03907481
10747 0.1168079 0.07566674 0.07711391 0.05230515      1 multDV 0.03861125
10748 0.1168079 0.07566674 0.07711391 0.05230515      1 multDV 0.03861125
24642 0.1138917 0.07763023 0.06945863 0.04826353      1 multDV 0.03889580
26260 0.1151995 0.07698840 0.07529012 0.05491084      1 multDV 0.03702265
26261 0.1151995 0.07698840 0.07529012 0.05491084      1 multDV 0.03702265
      rmseWetzels rmseSimonsohn chi2Sotola chi2Wetzels chi2Simonsohn rmseBump
10224 0.002241935     0.1265637   13.63442   0.1248091      6.056196 1.782548
24028 0.002256010     0.1233993   14.08534   0.1658235      5.808337 1.781696
24029 0.002256010     0.1233993   14.08534   0.1658235      5.808337 1.781696
25132 0.002338275     0.1256441   13.67148   0.1930553      5.957121 1.783942
25133 0.002338275     0.1256441   13.67148   0.1930553      5.957121 1.783942
10747 0.004146391     0.1216011   15.49477   0.2017915      5.819649 1.781860
10748 0.004146391     0.1216011   15.49477   0.2017915      5.819649 1.781860
24642 0.003457158     0.1268369   13.20983   0.3571218      6.032510 1.784470
26260 0.004563403     0.1211353   14.13918   0.3578009      5.694128 1.780687
26261 0.004563403     0.1211353   14.13918   0.3578009      5.694128 1.780687
      rmseBump2
10224 0.1276729
24028 0.1245385
24029 0.1245385
25132 0.1268089
25133 0.1268089
10747 0.1226747
10748 0.1226747
24642 0.1279895
26260 0.1221803
26261 0.1221803</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>simres_multDV[<span class="fu">order</span>(simres_multDV<span class="sc">$</span>chi2Simonsohn)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      nvar   r   d prop_Hacker prop_H1 het  iter alpha strategy        p1
12124   70 0.3 0.1        0.25     0.7 0.0 10000  0.05        1 0.4746060
12125   70 0.3 0.1        0.25     0.7 0.0 10000  0.05        2 0.4746060
5842    70 0.0 0.2        0.10     0.3 0.0 10000  0.05        1 0.5033408
5843    70 0.0 0.2        0.10     0.3 0.0 10000  0.05        2 0.5033408
5863   150 0.3 0.2        0.10     0.3 0.0 10000  0.05        1 0.5056117
5864   150 0.3 0.2        0.10     0.3 0.0 10000  0.05        2 0.5056117
28954   70 0.0 0.3        0.10     0.1 0.4 10000  0.05        1 0.5023923
28955   70 0.0 0.3        0.10     0.1 0.4 10000  0.05        2 0.5023923
14410   70 0.0 0.1        0.10     0.1 0.2 10000  0.05        1 0.4616883
14411   70 0.0 0.1        0.10     0.1 0.2 10000  0.05        2 0.4616883
             p2        p3         p4         p5 binsum   type rmseSotola
12124 0.2094571 0.1485114 0.08266200 0.08476357      1 multDV 0.10087171
12125 0.2094571 0.1485114 0.08266200 0.08476357      1 multDV 0.10087171
5842  0.1993318 0.1247216 0.08240535 0.09020045      1 multDV 0.08764502
5843  0.1993318 0.1247216 0.08240535 0.09020045      1 multDV 0.08764502
5863  0.1969697 0.1285073 0.08249158 0.08641975      1 multDV 0.08626337
5864  0.1969697 0.1285073 0.08249158 0.08641975      1 multDV 0.08626337
28954 0.2099282 0.1291866 0.08133971 0.07715311      1 multDV 0.09090764
28955 0.2099282 0.1291866 0.08133971 0.07715311      1 multDV 0.09090764
14410 0.2259740 0.1422078 0.08831169 0.08181818      1 multDV 0.10998910
14411 0.2259740 0.1422078 0.08831169 0.08181818      1 multDV 0.10998910
      rmseWetzels rmseSimonsohn chi2Sotola chi2Wetzels chi2Simonsohn rmseBump
12124  0.11007063    0.03135076   47.08042    143.5913      1.173617 1.757414
12125  0.11007063    0.03135076   47.08042    143.5913      1.173617 1.757414
5842   0.09470506    0.03686085   39.47646    105.3286      1.217320 1.756077
5843   0.09470506    0.03686085   39.47646    105.3286      1.217320 1.756077
5863   0.09352852    0.03861059   38.36191    102.4153      1.291414 1.757828
5864   0.09352852    0.03861059   38.36191    102.4153      1.291414 1.757828
28954  0.09663447    0.03856241   44.26376    109.0023      1.337119 1.761911
28955  0.09663447    0.03856241   44.26376    109.0023      1.337119 1.761911
14410  0.11718067    0.03130113   58.81580    157.6561      1.377122 1.758348
14411  0.11718067    0.03130113   58.81580    157.6561      1.377122 1.758348
       rmseBump2
12124 0.03132704
12125 0.03132704
5842  0.03751251
5843  0.03751251
5863  0.03919612
5864  0.03919612
28954 0.03973723
28955 0.03973723
14410 0.03171778
14411 0.03171778</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pcurves</span>(<span class="at">simdat =</span> simres_multDV, <span class="at">poriginal =</span> pcurves[pcurves<span class="sc">$</span>dataset <span class="sc">==</span> <span class="st">"sotola"</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">n_best=</span><span class="dv">10</span>, <span class="at">GOF=</span><span class="st">"chi2"</span>, <span class="at">n =</span> pcurves<span class="sc">$</span>nsig[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="eval_simResults_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pcurves</span>(<span class="at">simdat =</span> simres_multDV, <span class="at">poriginal =</span> pcurves[pcurves<span class="sc">$</span>dataset <span class="sc">==</span> <span class="st">"wetzels"</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">n_best=</span><span class="dv">10</span>, <span class="at">GOF=</span><span class="st">"chi2"</span>, <span class="at">n =</span> pcurves<span class="sc">$</span>nsig[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="eval_simResults_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pcurves</span>(<span class="at">simdat =</span> simres_multDV, <span class="at">poriginal =</span> pcurves[pcurves<span class="sc">$</span>dataset <span class="sc">==</span> <span class="st">"simonsohn"</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">n_best=</span><span class="dv">10</span>, <span class="at">GOF=</span><span class="st">"chi2"</span>, <span class="at">n =</span> pcurves<span class="sc">$</span>nsig[<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="eval_simResults_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pcurves</span>(<span class="at">simdat =</span> simres_optStop, <span class="at">poriginal =</span> pcurves[pcurves<span class="sc">$</span>dataset <span class="sc">==</span> <span class="st">"sotola"</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">n_best=</span><span class="dv">10</span>, <span class="at">GOF=</span><span class="st">"chi2"</span>, <span class="at">n =</span> pcurves<span class="sc">$</span>nsig[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="eval_simResults_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pcurves</span>(<span class="at">simdat =</span> simres_optStop, <span class="at">poriginal =</span> pcurves[pcurves<span class="sc">$</span>dataset <span class="sc">==</span> <span class="st">"wetzels"</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">n_best=</span><span class="dv">10</span>, <span class="at">GOF=</span><span class="st">"chi2"</span>, <span class="at">n =</span> pcurves<span class="sc">$</span>nsig[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="eval_simResults_files/figure-html/unnamed-chunk-10-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pcurves</span>(<span class="at">simdat =</span> simres_optStop, <span class="at">poriginal =</span> pcurves[pcurves<span class="sc">$</span>dataset <span class="sc">==</span> <span class="st">"simonsohn"</span>, <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">n_best=</span><span class="dv">10</span>, <span class="at">GOF=</span><span class="st">"chi2"</span>, <span class="at">n =</span> pcurves<span class="sc">$</span>nsig[<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="eval_simResults_files/figure-html/unnamed-chunk-10-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>